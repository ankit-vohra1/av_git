----REPLICATION DB

create user blms_rep identified by "ankit";
grant connect , resource to blms_rep;
grant UNLIMITED  tablespace  to blms_rep;
--select * from dba_directories;

grant execute,read,write on directory TEST_DIR to blms_rep;
grant execute on DBMS_SCHEDULER to blms_rep;
grant create job to blms_rep;

----MAIN DB

create user blms identified by "ankit";
grant connect , resource to blms;
grant UNLIMITED  tablespace  to blms;
select * from dba_directories;
grant execute,read,write on directory TEST_DIR to blms;
grant execute on DBMS_SCHEDULER to blms;
grant create job to blms;
grant create database link to blms;

--drop DATABASE LINK blms_rep;
CREATE  DATABASE LINK blms_rep CONNECT TO blms_rep IDENTIFIED BY ankit USING 
'(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521)) 
(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = orcl18c_rep)))';
/

BEGIN DBMS_SCHEDULER.drop_job(job_name            =>'GENERATE_LUXURY_TAX_RECS'); end;
/
BEGIN
  DBMS_SCHEDULER.create_job (
    job_name        => 'GENERATE_LUXURY_TAX_RECS',
    job_type        => 'PLSQL_BLOCK',
    job_action      => 'BEGIN blms.proc_lux_tax; END;',
    start_date      => SYSTIMESTAMP,
    repeat_interval => 'freq=monthly; bymonthday=1; byhour=1; byminute=0; bysecond=0;',
    enabled         => TRUE);
END;
/

select * from dba_scheduler_jobs where job_name='GENERATE_LUXURY_TAX_RECS';
select * from dba_scheduler_job_run_details where job_name='GENERATE_LUXURY_TAX_RECS' order by log_date desc;
BEGIN DBMS_SCHEDULER.run_job (job_name            =>'GENERATE_LUXURY_TAX_RECS');  END;
/

